# Import the necessary modules from Scapy
from scapy.all import *

# Define the network interface to use
interface = "eth0"

# Specify the IP range you want to scan, where "X.X" should be replaced with the actual IP range you want to scan
ip_range = "10.10.X.X/24"

# Define the broadcast MAC address
broadcastMac = "ff:ff:ff:ff:ff:ff"

# Create an Ethernet frame with an ARP request for the specified IP range
packet = Ether(dst=broadcastMac) / ARP(pdst=ip_range)

# Send the ARP request using the send and receive packets function (srp)
# Set a timeout of 2 seconds and specify the interface and inter-packet delay
ans, unans = srp(packet, timeout=2, iface=interface, inter=0.1)

# Iterate through the received packets and print the source MAC address and corresponding IP address
for send, receive in ans:
    print(receive.sprintf(r"%Ether.src% - %ARP.psrc%"))
